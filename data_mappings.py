# Mapping of Bay Area regions to  BLS nonfarm payroll series IDs (seasonally adjusted)
regions = {
    # Napa MSA, San Rafael MD, Santa Rosa-Petaluma, Vallejo
    "North Bay": ["SMS06349000000000001", "SMS06420340000000001", "SMS06422200000000001", "SMS06467000000000001"],
    # Oakland-Fremont-Berkeley MD
    "East Bay": "SMS06360840000000001", 
    # San Francisco-San Mateo-Redwood City MD
    "San Francisco-Peninsula": "SMS06418840000000001",
    # San Jose-Sunnyvale-Santa Clara
    "South Bay": "SMS06419400000000001",
    # Sonoma County (will delete later)
    "Sonoma County": "SMS06422200000000001",
    # United States
    "United States": "CES0000000001"
}

# Mapping of U.S. states to BLS nonfarm payroll series IDs (seasonally adjusted)
state_code_map = {
    "Alabama": "SMS01000000000000001",
    "Alaska": "SMS02000000000000001",
    "Arizona": "SMS04000000000000001",
    "Arkansas": "SMS05000000000000001",
    "California": "SMS06000000000000001",
    "Colorado": "SMS08000000000000001",
    "Connecticut": "SMS09000000000000001",
    "Delaware": "SMS10000000000000001",
    "District of Columbia": "SMS11000000000000001",
    "Florida": "SMS12000000000000001",
    "Georgia": "SMS13000000000000001",
    "Hawaii": "SMS15000000000000001",
    "Idaho": "SMS16000000000000001",
    "Illinois": "SMS17000000000000001",
    "Indiana": "SMS18000000000000001",
    "Iowa": "SMS19000000000000001",
    "Kansas": "SMS20000000000000001",
    "Kentucky": "SMS21000000000000001",
    "Louisiana": "SMS22000000000000001",
    "Maine": "SMS23000000000000001",
    "Maryland": "SMS24000000000000001",
    "Massachusetts": "SMS25000000000000001",
    "Michigan": "SMS26000000000000001",
    "Minnesota": "SMS27000000000000001",
    "Mississippi": "SMS28000000000000001",
    "Missouri": "SMS29000000000000001",
    "Montana": "SMS30000000000000001",
    "Nebraska": "SMS31000000000000001",
    "Nevada": "SMS32000000000000001",
    "New Hampshire": "SMS33000000000000001",
    "New Jersey": "SMS34000000000000001",
    "New Mexico": "SMS35000000000000001",
    "New York": "SMS36000000000000001",
    "North Carolina": "SMS37000000000000001",
    "North Dakota": "SMS38000000000000001",
    "Ohio": "SMS39000000000000001",
    "Oklahoma": "SMS40000000000000001",
    "Oregon": "SMS41000000000000001",
    "Pennsylvania": "SMS42000000000000001",
    "Rhode Island": "SMS44000000000000001",
    "South Carolina": "SMS45000000000000001",
    "South Dakota": "SMS46000000000000001",
    "Tennessee": "SMS47000000000000001",
    "Texas": "SMS48000000000000001",
    "Utah": "SMS49000000000000001",
    "Vermont": "SMS50000000000000001",
    "Virginia": "SMS51000000000000001",
    "Washington": "SMS53000000000000001",
    "West Virginia": "SMS54000000000000001",
    "Wisconsin": "SMS55000000000000001",
    "Wyoming": "SMS56000000000000001"
    # "Puerto Rico": "SMS72000000000000001",
    # "Virign Islands": "SMS78000000000000001"
}

bay_area_counties = [
    "Alameda County", "Contra Costa County", "Marin County",
    "Napa County", "San Francisco County", "San Mateo County",
    "Santa Clara County", "Solano County", "Sonoma County"
]

# Mapping for jobs by industry and by region
series_mapping = {
    'SMU06360842000000001': ('Oakland-Fremont-Berkeley, CA', 'Construction'),
    'SMU06418842000000001': ('San Francisco-San Mateo-Redwood City, CA', 'Construction'),
    'SMU06419402000000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Construction'),
    'SMU06420342000000001': ('San Rafael, CA', 'Construction'),
    'SMU06422202000000001': ('Santa Rosa-Petaluma, CA', 'Construction'),
    'SMU06467002000000001': ('Vallejo, CA', 'Construction'),
    'SMU06349003000000001': ('Napa, CA', 'Manufacturing'),
    'SMU06360843000000001': ('Oakland-Fremont-Berkeley, CA', 'Manufacturing'),
    'SMU06418843000000001': ('San Francisco-San Mateo-Redwood City, CA', 'Manufacturing'),
    'SMU06419403000000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Manufacturing'),
    'SMU06420343000000001': ('San Rafael, CA', 'Manufacturing'),
    'SMU06422203000000001': ('Santa Rosa-Petaluma, CA', 'Manufacturing'),
    'SMU06467003000000001': ('Vallejo, CA', 'Manufacturing'),
    # 'SMU06349004100000001': ('Napa, CA', 'Wholesale Trade'),
    # 'SMU06360844100000001': ('Oakland-Fremont-Berkeley, CA', 'Wholesale Trade'),
    # 'SMU06418844100000001': ('San Francisco-San Mateo-Redwood City, CA', 'Wholesale Trade'),
    # 'SMU06419404100000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Wholesale Trade'),
    # 'SMU06420344100000001': ('San Rafael, CA', 'Wholesale Trade'),
    # 'SMU06422204100000001': ('Santa Rosa-Petaluma, CA', 'Wholesale Trade'),
    # 'SMU06467004100000001': ('Vallejo, CA', 'Wholesale Trade'),
    'SMU06349004200000001': ('Napa, CA', 'Retail Trade'),
    'SMU06360844200000001': ('Oakland-Fremont-Berkeley, CA', 'Retail Trade'),
    'SMU06418844200000001': ('San Francisco-San Mateo-Redwood City, CA', 'Retail Trade'),
    'SMU06419404200000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Retail Trade'),
    'SMU06420344200000001': ('San Rafael, CA', 'Retail Trade'),
    'SMU06422204200000001': ('Santa Rosa-Petaluma, CA', 'Retail Trade'),
    'SMU06467004200000001': ('Vallejo, CA', 'Retail Trade'),
    # 'SMU06360844340008901': ('Oakland-Fremont-Berkeley, CA', 'Transportation and Warehousing'),
    # 'SMU06418844340008901': ('San Francisco-San Mateo-Redwood City, CA', 'Transportation and Warehousing'),
    # 'SMU06419404340008901': ('San Jose-Sunnyvale-Santa Clara, CA', 'Transportation and Warehousing'),
    'SMU06349005000000001': ('Napa, CA', 'Information'),
    'SMU06360845000000001': ('Oakland-Fremont-Berkeley, CA', 'Information'),
    'SMU06418845000000001': ('San Francisco-San Mateo-Redwood City, CA', 'Information'),
    'SMU06419405000000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Information'),
    'SMU06420345000000001': ('San Rafael, CA', 'Information'),
    'SMU06422205000000001': ('Santa Rosa-Petaluma, CA', 'Information'),
    'SMU06467005000000001': ('Vallejo, CA', 'Information'),
    # 'SMU06360845552000001': ('Oakland-Fremont-Berkeley, CA', 'Finance and Insurance'),
    # 'SMU06418845552000001': ('San Francisco-San Mateo-Redwood City, CA', 'Finance and Insurance'),
    # 'SMU06419405552000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Finance and Insurance'),
    # 'SMU06422205552000001': ('Santa Rosa-Petaluma, CA', 'Finance and Insurance'),
    # 'SMU06467005552000001': ('Vallejo, CA', 'Finance and Insurance'),
    # 'SMU06360845553000001': ('Oakland-Fremont-Berkeley, CA', 'Real Estate and Rental and Leasing'),
    # 'SMU06418845553000001': ('San Francisco-San Mateo-Redwood City, CA', 'Real Estate and Rental and Leasing'),
    # 'SMU06419405553000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Real Estate and Rental and Leasing'),
    'SMU06349006000000001': ('Napa, CA', 'Professional and Business Services'),
    'SMU06360846000000001': ('Oakland-Fremont-Berkeley, CA', 'Professional and Business Services'),
    'SMU06418846000000001': ('San Francisco-San Mateo-Redwood City, CA', 'Professional and Business Services'),
    'SMU06419406000000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Professional and Business Services'),
    'SMU06420346000000001': ('San Rafael, CA', 'Professional and Business Services'),
    'SMU06422206000000001': ('Santa Rosa-Petaluma, CA', 'Professional and Business Services'),
    'SMU06467006000000001': ('Vallejo, CA', 'Professional and Business Services'),
    # 'SMU06360846054000001': ('Oakland-Fremont-Berkeley, CA', 'Professional, Scientific, and Technical Services'),
    # 'SMU06418846054000001': ('San Francisco-San Mateo-Redwood City, CA', 'Professional, Scientific, and Technical Services'),
    # 'SMU06419406054000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Professional, Scientific, and Technical Services'),
    # 'SMU06422206054000001': ('Santa Rosa-Petaluma, CA', 'Professional, Scientific, and Technical Services'),
    # 'SMU06360846055000001': ('Oakland-Fremont-Berkeley, CA', 'Management of Companies and Enterprises'),
    # 'SMU06418846055000001': ('San Francisco-San Mateo-Redwood City, CA', 'Management of Companies and Enterprises'),
    # 'SMU06419406055000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Management of Companies and Enterprises'),
    # 'SMU06422206055000001': ('Santa Rosa-Petaluma, CA', 'Management of Companies and Enterprises'),
    # 'SMU06349006056000001': ('Napa, CA', 'Administrative and Support and Waste Management and Remediation Services'),
    # 'SMU06360846056000001': ('Oakland-Fremont-Berkeley, CA', 'Administrative and Support and Waste Management and Remediation Services'),
    # 'SMU06418846056000001': ('San Francisco-San Mateo-Redwood City, CA', 'Administrative and Support and Waste Management and Remediation Services'),
    # 'SMU06419406056000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Administrative and Support and Waste Management and Remediation Services'),
    # 'SMU06422206056000001': ('Santa Rosa-Petaluma, CA', 'Administrative and Support and Waste Management and Remediation Services'),
    # 'SMU06467006056000001': ('Vallejo, CA', 'Administrative and Support and Waste Management and Remediation Services'),
    # 'SMU06360846561000001': ('Oakland-Fremont-Berkeley, CA', 'Private Educational Services'),
    # 'SMU06418846561000001': ('San Francisco-San Mateo-Redwood City, CA', 'Private Educational Services'),
    # 'SMU06419406561000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Private Educational Services'),
    # 'SMU06349006562000001': ('Napa, CA', 'Health Care and Social Assistance'),
    # 'SMU06360846562000001': ('Oakland-Fremont-Berkeley, CA', 'Health Care and Social Assistance'),
    # 'SMU06418846562000001': ('San Francisco-San Mateo-Redwood City, CA', 'Health Care and Social Assistance'),
    # 'SMU06419406562000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Health Care and Social Assistance'),
    # 'SMU06422206562000001': ('Santa Rosa-Petaluma, CA', 'Health Care and Social Assistance'),
    # 'SMU06467006562000001': ('Vallejo, CA', 'Health Care and Social Assistance'),
    # 'SMU06360847071000001': ('Oakland-Fremont-Berkeley, CA', 'Arts, Entertainment, and Recreation'),
    # 'SMU06418847071000001': ('San Francisco-San Mateo-Redwood City, CA', 'Arts, Entertainment, and Recreation'),
    # 'SMU06349007072000001': ('Napa, CA', 'Accommodation and Food Services'),
    # 'SMU06360847072000001': ('Oakland-Fremont-Berkeley, CA', 'Accommodation and Food Services'),
    # 'SMU06418847072000001': ('San Francisco-San Mateo-Redwood City, CA', 'Accommodation and Food Services'),
    # 'SMU06419407072000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Accommodation and Food Services'),
    # 'SMU06422207072000001': ('Santa Rosa-Petaluma, CA', 'Accommodation and Food Services'),
    # 'SMU06467007072000001': ('Vallejo, CA', 'Accommodation and Food Services'),
    'SMU06349009000000001': ('Napa, CA', 'Government'),
    'SMU06360849000000001': ('Oakland-Fremont-Berkeley, CA', 'Government'),
    'SMU06418849000000001': ('San Francisco-San Mateo-Redwood City, CA', 'Government'),
    'SMU06419409000000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Government'),
    'SMU06420349000000001': ('San Rafael, CA', 'Government'),
    'SMU06422209000000001': ('Santa Rosa-Petaluma, CA', 'Government'),
    'SMU06467009000000001': ('Vallejo, CA', 'Government'),
    'SMU06349007000000001': ('Napa, CA', 'Leisure and Hospitality'),
    'SMU06360847000000001': ('Oakland-Fremont-Berkeley, CA', 'Leisure and Hospitality'),
    'SMU06418847000000001': ('San Francisco-San Mateo-Redwood City, CA', 'Leisure and Hospitality'),
    'SMU06419407000000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Leisure and Hospitality'),
    'SMU06420347000000001': ('San Rafael, CA', 'Leisure and Hospitality'),
    'SMU06422207000000001': ('Santa Rosa-Petaluma, CA', 'Leisure and Hospitality'),
    'SMU06467007000000001': ('Vallejo, CA', 'Leisure and Hospitality'),
    'SMU06349005500000001': ('Napa, CA', 'Financial Activities'),
    'SMU06360845500000001': ('Oakland-Fremont-Berkeley, CA', 'Financial Activities'),
    'SMU06418845500000001': ('San Francisco-San Mateo-Redwood City, CA', 'Financial Activities'),
    'SMU06419405500000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Financial Activities'),
    'SMU06420345500000001': ('San Rafael, CA', 'Financial Activities'),
    'SMU06422205500000001': ('Santa Rosa-Petaluma, CA', 'Financial Activities'),
    'SMU06467005500000001': ('Vallejo, CA', 'Financial Activities'),
    'SMU06349006500000001': ('Napa, CA', 'Education and Health Services'),
    'SMU06360846500000001': ('Oakland-Fremont-Berkeley, CA', 'Education and Health Services'),
    'SMU06418846500000001': ('San Francisco-San Mateo-Redwood City, CA', 'Education and Health Services'),
    'SMU06419406500000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Education and Health Services'),
    'SMU06420346500000001': ('San Rafael, CA', 'Education and Health Services'),
    'SMU06422206500000001': ('Santa Rosa-Petaluma, CA', 'Education and Health Services'),
    'SMU06467006500000001': ('Vallejo, CA', 'Education and Health Services'),
    'SMU06349004000000001': ('Napa, CA', 'Trade, Transportation, and Utilities'),
    'SMU06360844000000001': ('Oakland-Fremont-Berkeley, CA', 'Trade, Transportation, and Utilities'),
    'SMU06418844000000001': ('San Francisco-San Mateo-Redwood City, CA', 'Trade, Transportation, and Utilities'),
    'SMU06419404000000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Trade, Transportation, and Utilities'),
    'SMU06420344000000001': ('San Rafael, CA', 'Trade, Transportation, and Utilities'),
    'SMU06422204000000001': ('Santa Rosa-Petaluma, CA', 'Trade, Transportation, and Utilities'),
    'SMU06467004000000001': ('Vallejo, CA', 'Trade, Transportation, and Utilities'),
    'SMU06467004000000001': ('Vallejo, CA', 'Trade, Transportation, and Utilities'),
}

series_mapping_v2 = {
    'SMU06360842000000001': ('Oakland-Fremont-Berkeley, CA', 'Construction'),
    'SMU06418842000000001': ('San Francisco-San Mateo-Redwood City, CA', 'Construction'),
    'SMU06419402000000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Construction'),
    'SMU06420342000000001': ('San Rafael, CA', 'Construction'),
    'SMU06422202000000001': ('Santa Rosa-Petaluma, CA', 'Construction'),
    'SMU06467002000000001': ('Vallejo, CA', 'Construction'),
    'SMU06349003000000001': ('Napa, CA', 'Manufacturing'),
    'SMU06360843000000001': ('Oakland-Fremont-Berkeley, CA', 'Manufacturing'),
    'SMU06418843000000001': ('San Francisco-San Mateo-Redwood City, CA', 'Manufacturing'),
    'SMU06419403000000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Manufacturing'),
    'SMU06420343000000001': ('San Rafael, CA', 'Manufacturing'),
    'SMU06422203000000001': ('Santa Rosa-Petaluma, CA', 'Manufacturing'),
    'SMU06467003000000001': ('Vallejo, CA', 'Manufacturing'),
    # 'SMU06349004100000001': ('Napa, CA', 'Wholesale Trade'),
    # 'SMU06360844100000001': ('Oakland-Fremont-Berkeley, CA', 'Wholesale Trade'),
    # 'SMU06418844100000001': ('San Francisco-San Mateo-Redwood City, CA', 'Wholesale Trade'),
    # 'SMU06419404100000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Wholesale Trade'),
    # 'SMU06420344100000001': ('San Rafael, CA', 'Wholesale Trade'),
    # 'SMU06422204100000001': ('Santa Rosa-Petaluma, CA', 'Wholesale Trade'),
    # 'SMU06467004100000001': ('Vallejo, CA', 'Wholesale Trade'),
    'SMU06349004200000001': ('Napa, CA', 'Retail Trade'),
    'SMU06360844200000001': ('Oakland-Fremont-Berkeley, CA', 'Retail Trade'),
    'SMU06418844200000001': ('San Francisco-San Mateo-Redwood City, CA', 'Retail Trade'),
    'SMU06419404200000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Retail Trade'),
    'SMU06420344200000001': ('San Rafael, CA', 'Retail Trade'),
    'SMU06422204200000001': ('Santa Rosa-Petaluma, CA', 'Retail Trade'),
    'SMU06467004200000001': ('Vallejo, CA', 'Retail Trade'),
    # 'SMU06360844340008901': ('Oakland-Fremont-Berkeley, CA', 'Transportation and Warehousing'),
    # 'SMU06418844340008901': ('San Francisco-San Mateo-Redwood City, CA', 'Transportation and Warehousing'),
    # 'SMU06419404340008901': ('San Jose-Sunnyvale-Santa Clara, CA', 'Transportation and Warehousing'),
    'SMU06349005000000001': ('Napa, CA', 'Information'),
    'SMU06360845000000001': ('Oakland-Fremont-Berkeley, CA', 'Information'),
    'SMU06418845000000001': ('San Francisco-San Mateo-Redwood City, CA', 'Information'),
    'SMU06419405000000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Information'),
    'SMU06420345000000001': ('San Rafael, CA', 'Information'),
    'SMU06422205000000001': ('Santa Rosa-Petaluma, CA', 'Information'),
    'SMU06467005000000001': ('Vallejo, CA', 'Information'),
    # 'SMU06360845552000001': ('Oakland-Fremont-Berkeley, CA', 'Finance and Insurance'),
    # 'SMU06418845552000001': ('San Francisco-San Mateo-Redwood City, CA', 'Finance and Insurance'),
    # 'SMU06419405552000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Finance and Insurance'),
    # 'SMU06422205552000001': ('Santa Rosa-Petaluma, CA', 'Finance and Insurance'),
    # 'SMU06467005552000001': ('Vallejo, CA', 'Finance and Insurance'),
    # 'SMU06360845553000001': ('Oakland-Fremont-Berkeley, CA', 'Real Estate and Rental and Leasing'),
    # 'SMU06418845553000001': ('San Francisco-San Mateo-Redwood City, CA', 'Real Estate and Rental and Leasing'),
    # 'SMU06419405553000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Real Estate and Rental and Leasing'),
    'SMU06349006000000001': ('Napa, CA', 'Professional and Business Services'),
    'SMU06360846000000001': ('Oakland-Fremont-Berkeley, CA', 'Professional and Business Services'),
    'SMU06418846000000001': ('San Francisco-San Mateo-Redwood City, CA', 'Professional and Business Services'),
    'SMU06419406000000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Professional and Business Services'),
    'SMU06420346000000001': ('San Rafael, CA', 'Professional and Business Services'),
    'SMU06422206000000001': ('Santa Rosa-Petaluma, CA', 'Professional and Business Services'),
    'SMU06467006000000001': ('Vallejo, CA', 'Professional and Business Services'),
    # 'SMU06360846054000001': ('Oakland-Fremont-Berkeley, CA', 'Professional, Scientific, and Technical Services'),
    # 'SMU06418846054000001': ('San Francisco-San Mateo-Redwood City, CA', 'Professional, Scientific, and Technical Services'),
    # 'SMU06419406054000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Professional, Scientific, and Technical Services'),
    # 'SMU06422206054000001': ('Santa Rosa-Petaluma, CA', 'Professional, Scientific, and Technical Services'),
    # 'SMU06360846055000001': ('Oakland-Fremont-Berkeley, CA', 'Management of Companies and Enterprises'),
    # 'SMU06418846055000001': ('San Francisco-San Mateo-Redwood City, CA', 'Management of Companies and Enterprises'),
    # 'SMU06419406055000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Management of Companies and Enterprises'),
    # 'SMU06422206055000001': ('Santa Rosa-Petaluma, CA', 'Management of Companies and Enterprises'),
    # 'SMU06349006056000001': ('Napa, CA', 'Administrative and Support and Waste Management and Remediation Services'),
    # 'SMU06360846056000001': ('Oakland-Fremont-Berkeley, CA', 'Administrative and Support and Waste Management and Remediation Services'),
    # 'SMU06418846056000001': ('San Francisco-San Mateo-Redwood City, CA', 'Administrative and Support and Waste Management and Remediation Services'),
    # 'SMU06419406056000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Administrative and Support and Waste Management and Remediation Services'),
    # 'SMU06422206056000001': ('Santa Rosa-Petaluma, CA', 'Administrative and Support and Waste Management and Remediation Services'),
    # 'SMU06467006056000001': ('Vallejo, CA', 'Administrative and Support and Waste Management and Remediation Services'),
    # 'SMU06360846561000001': ('Oakland-Fremont-Berkeley, CA', 'Private Educational Services'),
    # 'SMU06418846561000001': ('San Francisco-San Mateo-Redwood City, CA', 'Private Educational Services'),
    # 'SMU06419406561000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Private Educational Services'),
    # 'SMU06349006562000001': ('Napa, CA', 'Health Care and Social Assistance'),
    # 'SMU06360846562000001': ('Oakland-Fremont-Berkeley, CA', 'Health Care and Social Assistance'),
    # 'SMU06418846562000001': ('San Francisco-San Mateo-Redwood City, CA', 'Health Care and Social Assistance'),
    # 'SMU06419406562000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Health Care and Social Assistance'),
    # 'SMU06422206562000001': ('Santa Rosa-Petaluma, CA', 'Health Care and Social Assistance'),
    # 'SMU06467006562000001': ('Vallejo, CA', 'Health Care and Social Assistance'),
    # 'SMU06360847071000001': ('Oakland-Fremont-Berkeley, CA', 'Arts, Entertainment, and Recreation'),
    # 'SMU06418847071000001': ('San Francisco-San Mateo-Redwood City, CA', 'Arts, Entertainment, and Recreation'),
    # 'SMU06349007072000001': ('Napa, CA', 'Accommodation and Food Services'),
    # 'SMU06360847072000001': ('Oakland-Fremont-Berkeley, CA', 'Accommodation and Food Services'),
    # 'SMU06418847072000001': ('San Francisco-San Mateo-Redwood City, CA', 'Accommodation and Food Services'),
    # 'SMU06419407072000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Accommodation and Food Services'),
    # 'SMU06422207072000001': ('Santa Rosa-Petaluma, CA', 'Accommodation and Food Services'),
    # 'SMU06467007072000001': ('Vallejo, CA', 'Accommodation and Food Services'),
    'SMU06349009000000001': ('Napa, CA', 'Government'),
    'SMU06360849000000001': ('Oakland-Fremont-Berkeley, CA', 'Government'),
    'SMU06418849000000001': ('San Francisco-San Mateo-Redwood City, CA', 'Government'),
    'SMU06419409000000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Government'),
    'SMU06420349000000001': ('San Rafael, CA', 'Government'),
    'SMU06422209000000001': ('Santa Rosa-Petaluma, CA', 'Government'),
    'SMU06467009000000001': ('Vallejo, CA', 'Government'),
    'SMU06349007000000001': ('Napa, CA', 'Leisure and Hospitality'),
    'SMU06360847000000001': ('Oakland-Fremont-Berkeley, CA', 'Leisure and Hospitality'),
    'SMU06418847000000001': ('San Francisco-San Mateo-Redwood City, CA', 'Leisure and Hospitality'),
    'SMU06419407000000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Leisure and Hospitality'),
    'SMU06420347000000001': ('San Rafael, CA', 'Leisure and Hospitality'),
    'SMU06422207000000001': ('Santa Rosa-Petaluma, CA', 'Leisure and Hospitality'),
    'SMU06467007000000001': ('Vallejo, CA', 'Leisure and Hospitality'),
    'SMU06349005500000001': ('Napa, CA', 'Financial Activities'),
    'SMU06360845500000001': ('Oakland-Fremont-Berkeley, CA', 'Financial Activities'),
    'SMU06418845500000001': ('San Francisco-San Mateo-Redwood City, CA', 'Financial Activities'),
    'SMU06419405500000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Financial Activities'),
    'SMU06420345500000001': ('San Rafael, CA', 'Financial Activities'),
    'SMU06422205500000001': ('Santa Rosa-Petaluma, CA', 'Financial Activities'),
    'SMU06467005500000001': ('Vallejo, CA', 'Financial Activities'),
    'SMU06349006500000001': ('Napa, CA', 'Education and Health Services'),
    'SMU06360846500000001': ('Oakland-Fremont-Berkeley, CA', 'Education and Health Services'),
    'SMU06418846500000001': ('San Francisco-San Mateo-Redwood City, CA', 'Education and Health Services'),
    'SMU06419406500000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Education and Health Services'),
    'SMU06420346500000001': ('San Rafael, CA', 'Education and Health Services'),
    'SMU06422206500000001': ('Santa Rosa-Petaluma, CA', 'Education and Health Services'),
    'SMU06467006500000001': ('Vallejo, CA', 'Education and Health Services'),
    'SMU06349004000000001': ('Napa, CA', 'Trade, Transportation, and Utilities'),
    'SMU06360844000000001': ('Oakland-Fremont-Berkeley, CA', 'Trade, Transportation, and Utilities'),
    'SMU06418844000000001': ('San Francisco-San Mateo-Redwood City, CA', 'Trade, Transportation, and Utilities'),
    'SMU06419404000000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Trade, Transportation, and Utilities'),
    'SMU06420344000000001': ('San Rafael, CA', 'Trade, Transportation, and Utilities'),
    'SMU06422204000000001': ('Santa Rosa-Petaluma, CA', 'Trade, Transportation, and Utilities'),
    'SMU06467004000000001': ('Vallejo, CA', 'Trade, Transportation, and Utilities'),
    'SMU06467004000000001': ('Vallejo, CA', 'Trade, Transportation, and Utilities'),
}

us_series_mapping = {
    'CES2000000001': ('United States', 'Construction'),
    'CES3000000001': ('United States', 'Manufacturing'),
    'CES4200000001': ('United States', 'Retail'),
    'CES5000000001': ('United States', 'Information'),
    'CES5500000001': ('United States', 'Financial Activities'),
    'CES6000000001': ('United States', 'Professional and Business Services'),
    'CES7000000001': ('United States', 'Leisure and Hospitality'),
    'CES9000000001': ('United States', 'Government'),
    'CES4000000001': ('United States', 'Trade, Transportation, and Utilities'),
    'CES6500000001': ('United States', 'Education and Health Services')
}


sonoma_mapping = {
    'SMU06422202000000001': ('Santa Rosa-Petaluma, CA', 'Construction'),
    'SMU06422203000000001': ('Santa Rosa-Petaluma, CA', 'Manufacturing'),
    'SMU06422204200000001': ('Santa Rosa-Petaluma, CA', 'Retail Trade'),
    'SMU06422205000000001': ('Santa Rosa-Petaluma, CA', 'Information'),
    'SMU06422206000000001': ('Santa Rosa-Petaluma, CA', 'Professional and Business Services'),
    'SMU06422209000000001': ('Santa Rosa-Petaluma, CA', 'Government'),
    'SMU06422207000000001': ('Santa Rosa-Petaluma, CA', 'Leisure and Hospitality'),
    'SMU06422205500000001': ('Santa Rosa-Petaluma, CA', 'Financial Activities'),
    'SMU06422206500000001': ('Santa Rosa-Petaluma, CA', 'Education and Health Services'),
    'SMU06422204000000001': ('Santa Rosa-Petaluma, CA', 'Trade, Transportation, and Utilities'),
}

# Mapping for BLS employment numbers in office / teach industries across major metros
office_metros_mapping = {
    'SMU13120605000000001': ('Atlanta-Sandy Springs-Roswell, GA', 'Information'),
    'SMU13120605500000001': ('Atlanta-Sandy Springs-Roswell, GA', 'Financial Activities'),
    'SMU13120606000000001': ('Atlanta-Sandy Springs-Roswell, GA', 'Professional and Business Services'),
    'SMU48124205000000001': ('Austin-Round Rock-San Marcos, TX', 'Information'),
    'SMU48124205500000001': ('Austin-Round Rock-San Marcos, TX', 'Financial Activities'),
    'SMU48124206000000001': ('Austin-Round Rock-San Marcos, TX', 'Professional and Business Services'),
    'SMU25144605000000001': ('Boston-Cambridge-Newton, MA-NH', 'Information'),
    'SMU25144605500000001': ('Boston-Cambridge-Newton, MA-NH', 'Financial Activities'),
    'SMU25144606000000001': ('Boston-Cambridge-Newton, MA-NH', 'Professional and Business Services'),
    'SMU17169805000000001': ('Chicago-Naperville-Elgin, IL-IN-WI', 'Information'),
    'SMU17169805500000001': ('Chicago-Naperville-Elgin, IL-IN-WI', 'Financial Activities'),
    'SMU17169806000000001': ('Chicago-Naperville-Elgin, IL-IN-WI', 'Professional and Business Services'),
    'SMU48191005000000001': ('Dallas-Fort Worth-Arlington, TX', 'Information'),
    'SMU48191005500000001': ('Dallas-Fort Worth-Arlington, TX', 'Financial Activities'),
    'SMU48191006000000001': ('Dallas-Fort Worth-Arlington, TX', 'Professional and Business Services'),
    'SMU08197405000000001': ('Denver-Aurora-Centennial, CO', 'Information'),
    'SMU08197405500000001': ('Denver-Aurora-Centennial, CO', 'Financial Activities'),
    'SMU08197406000000001': ('Denver-Aurora-Centennial, CO', 'Professional and Business Services'),
    'SMU48264205000000001': ('Houston-Pasadena-The Woodlands, TX', 'Information'),
    'SMU48264205500000001': ('Houston-Pasadena-The Woodlands, TX', 'Financial Activities'),
    'SMU48264206000000001': ('Houston-Pasadena-The Woodlands, TX', 'Professional and Business Services'),
    'SMU06310805000000001': ('Los Angeles-Long Beach-Anaheim, CA', 'Information'),
    'SMU06310805500000001': ('Los Angeles-Long Beach-Anaheim, CA', 'Financial Activities'),
    'SMU06310806000000001': ('Los Angeles-Long Beach-Anaheim, CA', 'Professional and Business Services'),
    'SMU12331005000000001': ('Miami-Fort Lauderdale-West Palm Beach, FL', 'Information'),
    'SMU12331005500000001': ('Miami-Fort Lauderdale-West Palm Beach, FL', 'Financial Activities'),
    'SMU12331006000000001': ('Miami-Fort Lauderdale-West Palm Beach, FL', 'Professional and Business Services'),
    'SMU36356205000000001': ('New York-Newark-Jersey City, NY-NJ', 'Information'),
    'SMU36356205500000001': ('New York-Newark-Jersey City, NY-NJ', 'Financial Activities'),
    'SMU36356206000000001': ('New York-Newark-Jersey City, NY-NJ', 'Professional and Business Services'),
    'SMU04380605000000001': ('Phoenix-Mesa-Chandler, AZ', 'Information'),
    'SMU04380605500000001': ('Phoenix-Mesa-Chandler, AZ', 'Financial Activities'),
    'SMU04380606000000001': ('Phoenix-Mesa-Chandler, AZ', 'Professional and Business Services'),
    'SMU06417405000000001': ('San Diego-Chula Vista-Carlsbad, CA', 'Information'),
    'SMU06417405500000001': ('San Diego-Chula Vista-Carlsbad, CA', 'Financial Activities'),
    'SMU06417406000000001': ('San Diego-Chula Vista-Carlsbad, CA', 'Professional and Business Services'),
    'SMU06418605000000001': ('San Francisco-Oakland-Fremont, CA', 'Information'),
    'SMU06418605500000001': ('San Francisco-Oakland-Fremont, CA', 'Financial Activities'),
    'SMU06418606000000001': ('San Francisco-Oakland-Fremont, CA', 'Professional and Business Services'),
    'SMU06419405000000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Information'),
    'SMU06419405500000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Financial Activities'),
    'SMU06419406000000001': ('San Jose-Sunnyvale-Santa Clara, CA', 'Professional and Business Services'),
    'SMU53426605000000001': ('Seattle-Tacoma-Bellevue, WA', 'Information'),
    'SMU53426605500000001': ('Seattle-Tacoma-Bellevue, WA', 'Financial Activities'),
    'SMU53426606000000001': ('Seattle-Tacoma-Bellevue, WA', 'Professional and Business Services'),
    'SMU11479005000000001': ('Washington-Arlington-Alexandria, DC-VA-MD-WV', 'Information'),
    'SMU11479005500000001': ('Washington-Arlington-Alexandria, DC-VA-MD-WV', 'Financial Activities'),
    'SMU11479006000000001': ('Washington-Arlington-Alexandria, DC-VA-MD-WV', 'Professional and Business Services')
    # 'SMU06422205000000001': ('Santa Rosa-Petaluma, CA', 'Information'),
    # 'SMU06422205500000001': ('Santa Rosa-Petaluma, CA', 'Financial Activities'),
    # 'SMU06422205552000001': ('Santa Rosa-Petaluma, CA', 'Professional and Business Services')
}

rename_mapping = {
    "Atlanta-Sandy Springs-Roswell, GA": "Atlanta",
    "Austin-Round Rock-San Marcos, TX": "Austin",
    "Boston-Cambridge-Newton, MA-NH": "Boston",
    "Chicago-Naperville-Elgin, IL-IN-WI": "Chicago",
    "Dallas-Fort Worth-Arlington, TX": "Dallas",
    "Denver-Aurora-Centennial, CO": "Denver",
    "Houston-Pasadena-The Woodlands, TX": "Houston",
    "Los Angeles-Long Beach-Anaheim, CA": "Los Angeles",
    "Miami-Fort Lauderdale-West Palm Beach, FL": "Miami",
    "New York-Newark-Jersey City, NY-NJ": "New York",
    "Phoenix-Mesa-Chandler, AZ": "Phoenix",
    "San Diego-Chula Vista-Carlsbad, CA": "San Diego",
    "San Francisco-Oakland-Fremont, CA": "San Francisco",
    "San Jose-Sunnyvale-Santa Clara, CA": "San Jose",
    "Seattle-Tacoma-Bellevue, WA": "Seattle",
    "Washington-Arlington-Alexandria, DC-VA-MD-WV": "Washington D.C.",
    "Santa Rosa-Petaluma, CA": "Sonoma County"
}

color_map = {
    '9-county Bay Area': '#203864',
    'Alameda County': "#577CBE",
    'Contra Costa County': "#75affc",
    'Marin County': '#d84f19',
    'Napa County': '#eeaf30',
    'San Francisco County': '#7e8082',
    'San Mateo County': "#54b1ad",
    'Santa Clara County': "#09E6E2",
    'Solano County': "#063b61",
    'Sonoma County': '#00aca2'
}